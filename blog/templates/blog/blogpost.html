{% extends 'blog/basic.html' %}
{% block title %}Blog post - BlogLikho{% endblock %}
{% load humanize %}
{% load static %}
{% block body %}
<div class="container my-4">
    <div class="row g-5">
    <div class="col-md-8">
      <h3 class="pb-4 mb-4 fst-italic border-bottom">
        {{post.title}}
      </h3>

      <article class="blog-post">
        <h2 class="blog-post-title">{{post.heading1}}</h2>
        <p class="blog-post-meta">{{post.pub_date}} by <a href="#">{{post.author}}</a></p>

        <p>{{post.content1}}</p>
        <h2>{{post.heading2}}</h2>
        <p>{{post.content2}}</p>
        <h3>Sub-heading</h3>
        <p>This is some additional paragraph placeholder content. It has been written to fill the available space and show how a longer snippet of text affects the surrounding content. We'll repeat it often to keep the demonstration flowing, so be on the lookout for this exact same string of text.</p>
        <pre><code>Example code block</code></pre>
        <p>This is some additional paragraph placeholder content. It's a slightly shorter version of the other highly repetitive body text used throughout.</p>
      </article>

      <div class="my-4">
      <h2>Comments({{comments.count}})</h2>
      <div>
      {% if user.is_authenticated %}
      <form action="/blogs/postcomment" method="POST">{% csrf_token %}
        <div class="mb-3">
          <label for="comment" class="form-label">Post a Comment</label>
          <input type="text" class="form-control" id="comment" name="comment" placeholder="">
        </div>
        <input type="hidden" class="form-control" id="postId" name="postId" value="{{post.blog_id}}" placeholder="">
        <button type="submit" class="btn btn-primary">Submit</button></form>
        {% else %}
        <p class="bg-warning text-white" style="opacity:70%; text-align:center; padding:10px; border-radius:12px"><img src="{% static 'blog/lock.png' %}" style="width: 25px; height: 25px;"> &nbsp<b>Please Sign Up and Login To Comment.</b></p>
      {% endif %}
        </div>
      {% for comment in comments %}
      <div class="row mx-0 my-3">
      <div class="col-md-1">
      <img src="{% static 'blog/user.png' %}" class="rounded mx-auto w-100 d-block">
      </div>
      <div class="col-md-11"><b>{{comment.user.username}}</b>
      <span class="badge bg-secondary">{{comment.timestamp | naturaltime}}</span>
      <div class="my-2">{{comment.comment}}</div>
      </div>
      </div>
      {% endfor %}
      </div>

      <nav class="blog-pagination" style="text-align:center;" aria-label="Pagination">  
      <span id="prevblog"> 
        </span>
        <span id="nextblog">
        </span>
      </nav>

    </div>

    <div class="col-md-4">
      <div class="position-sticky" style="top: 2rem;">
        <div class="p-4 mb-3 bg-light rounded">
          <h4 class="fst-italic">About</h4>
          <p class="mb-0">{{post.about}}</p>
        </div>


        <div class="p-4">
          <h4 class="fst-italic">Find Me On</h4>
          <ol class="list-unstyled">
            <li><a href="#">GitHub</a></li>
            <li><a href="#">Twitter</a></li>
            <li><a href="#">Facebook</a></li>
          </ol>
        </div>
        <p>
        <button type="button" class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample" onclick="getURL()">Share</button>
      </p>
        <div class="collapse" id="collapseExample">
        <div class="card card-body" id="touch">
          
        </div>
      </div>
      </div>
    </div>
  </div>
  </div>
{% endblock %}
{% block js %}
    if ({{post.blog_id}} - 1 >= 1){
        prev={{post.blog_id}} - 1
        prevpost=`<a class="btn btn-outline-primary" href="/blogs/blogpost/${prev}">Previous</a>`
        $("#prevblog").append(prevpost)
    }
    if ({{post.blog_id}} + 1 <= {{range}}){
        next={{post.blog_id}} + 1
        nextpost=`<a class="btn btn-outline-success" href="/blogs/blogpost/${next}">Next</a>`
        $("#nextblog").append(nextpost)
    }
    function getURL() {
        var url=window.location.href;
        document.getElementById("touch").innerHTML=url
    }
{% endblock %}